\doxysection{cfd\+\_\+mx/inc/dfib/update\+\_\+u\+\_\+and\+\_\+force.hpp File Reference}
\hypertarget{update__u__and__force_8hpp}{}\label{update__u__and__force_8hpp}\index{cfd\_mx/inc/dfib/update\_u\_and\_force.hpp@{cfd\_mx/inc/dfib/update\_u\_and\_force.hpp}}
{\ttfamily \#include "{}backend/physical\+\_\+variables.\+hpp"{}}\newline
{\ttfamily \#include "{}../backend/domain.\+hpp"{}}\newline
{\ttfamily \#include "{}../grid/structured\+\_\+grid.\+hpp"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{update__u__and__force_8hpp_a9de53d7f5d4d7ae0ead7f7c31a2a27da}{Update\+Force\+And\+Velocity}} (\mbox{\hyperlink{class_immersed_boundary}{Immersed\+Boundary}} \&dfib, const double dt, const \mbox{\hyperlink{class_pressure}{Pressure}} \&pressure, const \mbox{\hyperlink{class_staggered_velocity}{Staggered\+Velocity}} \&old\+\_\+vel, \mbox{\hyperlink{class_staggered_velocity}{Staggered\+Velocity}} \&curr\+\_\+vel, const \mbox{\hyperlink{class_local_domain}{Local\+Domain}} \&location, \mbox{\hyperlink{class_structured_grid}{Structured\+Grid}} \&grid)
\item 
void \mbox{\hyperlink{update__u__and__force_8hpp_a7750d4010a2aefa928f308348ca499af}{Remove\+Velocity}} (const \mbox{\hyperlink{class_immersed_boundary}{Immersed\+Boundary}} \&dfib, \mbox{\hyperlink{class_staggered_velocity}{Staggered\+Velocity}} \&vel, const \mbox{\hyperlink{class_local_domain}{Local\+Domain}} \&location)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{update__u__and__force_8hpp_a7750d4010a2aefa928f308348ca499af}\label{update__u__and__force_8hpp_a7750d4010a2aefa928f308348ca499af} 
\index{update\_u\_and\_force.hpp@{update\_u\_and\_force.hpp}!RemoveVelocity@{RemoveVelocity}}
\index{RemoveVelocity@{RemoveVelocity}!update\_u\_and\_force.hpp@{update\_u\_and\_force.hpp}}
\doxysubsubsection{\texorpdfstring{RemoveVelocity()}{RemoveVelocity()}}
{\footnotesize\ttfamily void Remove\+Velocity (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_immersed_boundary}{Immersed\+Boundary}} \&}]{dfib,  }\item[{\mbox{\hyperlink{class_staggered_velocity}{Staggered\+Velocity}} \&}]{vel,  }\item[{const \mbox{\hyperlink{class_local_domain}{Local\+Domain}} \&}]{location }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{update__u__and__force_8hpp_source_l00075}{75}} of file \mbox{\hyperlink{update__u__and__force_8hpp_source}{update\+\_\+u\+\_\+and\+\_\+force.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ firstprivate(location)}}
\DoxyCodeLine{00078\ \ \ \ \ \{}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#pragma\ omp\ for\ simd\ nowait}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ location.\mbox{\hyperlink{class_local_domain_a47ac8bc4ed8a90613309ddced1869785}{x\_start}};\ i\ <\ location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}};\ ++i)}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ j\ =\ location.\mbox{\hyperlink{class_local_domain_af8a435144ad06a2bb6a290a341dab55e}{y\_start}};\ j\ <\ location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}};\ ++j)}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ k\ =\ location.\mbox{\hyperlink{class_local_domain_a7a4df338f67d20b9780e909913e93d10}{z\_start}};\ k\ <\ location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}};\ ++k)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ vel.\mbox{\hyperlink{class_staggered_velocity_aa6247ed37fbf51bbfe8bd31c567d7336}{U}}(i,\ j,\ k)\ *=\ 0.5\ *\ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i\ +\ 1,\ j,\ k));}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ vel.\mbox{\hyperlink{class_staggered_velocity_a84a6565ddac26a98251453d89767426e}{V}}(i,\ j,\ k)\ *=\ 0.5\ *\ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j\ +\ 1,\ k));}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ vel.\mbox{\hyperlink{class_staggered_velocity_adb2f88931c3cca29866c5334bec50ee1}{W}}(i,\ j,\ k)\ *=\ 0.5\ *\ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k\ +\ 1));}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00087\ \ \ \ \ \}}
\DoxyCodeLine{00088\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{physical__variables_8hpp_source_l00156}{Immersed\+Boundary\+::\+Eta()}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00057}{Staggered\+Velocity\+::\+U()}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00062}{Staggered\+Velocity\+::\+V()}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00067}{Staggered\+Velocity\+::\+W()}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::x\+\_\+end}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::x\+\_\+start}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::y\+\_\+end}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::y\+\_\+start}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::z\+\_\+end}}, and \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::z\+\_\+start}}.

\Hypertarget{update__u__and__force_8hpp_a9de53d7f5d4d7ae0ead7f7c31a2a27da}\label{update__u__and__force_8hpp_a9de53d7f5d4d7ae0ead7f7c31a2a27da} 
\index{update\_u\_and\_force.hpp@{update\_u\_and\_force.hpp}!UpdateForceAndVelocity@{UpdateForceAndVelocity}}
\index{UpdateForceAndVelocity@{UpdateForceAndVelocity}!update\_u\_and\_force.hpp@{update\_u\_and\_force.hpp}}
\doxysubsubsection{\texorpdfstring{UpdateForceAndVelocity()}{UpdateForceAndVelocity()}}
{\footnotesize\ttfamily void Update\+Force\+And\+Velocity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_immersed_boundary}{Immersed\+Boundary}} \&}]{dfib,  }\item[{const double}]{dt,  }\item[{const \mbox{\hyperlink{class_pressure}{Pressure}} \&}]{pressure,  }\item[{const \mbox{\hyperlink{class_staggered_velocity}{Staggered\+Velocity}} \&}]{old\+\_\+vel,  }\item[{\mbox{\hyperlink{class_staggered_velocity}{Staggered\+Velocity}} \&}]{curr\+\_\+vel,  }\item[{const \mbox{\hyperlink{class_local_domain}{Local\+Domain}} \&}]{location,  }\item[{\mbox{\hyperlink{class_structured_grid}{Structured\+Grid}} \&}]{grid }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{update__u__and__force_8hpp_source_l00007}{7}} of file \mbox{\hyperlink{update__u__and__force_8hpp_source}{update\+\_\+u\+\_\+and\+\_\+force.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \ \ \ \ \textcolor{keyword}{auto}\ nx\ =\ grid.\mbox{\hyperlink{class_structured_grid_a729ba22ec783944242e7279c7edbd9d3}{nx}};}
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{keyword}{auto}\ ny\ =\ grid.\mbox{\hyperlink{class_structured_grid_acd2c4a5c87de501e98173c83838978b6}{ny}};}
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{keyword}{auto}\ nz\ =\ grid.\mbox{\hyperlink{class_structured_grid_a6d376bf512f0064c82b1af557dd59dd3}{nz}};}
\DoxyCodeLine{00014\ \ \ \ \ \textcolor{keyword}{auto}\ gc\ =\ grid.\mbox{\hyperlink{class_structured_grid_a588ce27c2f4a42580d8c7ea85524a427}{no\_ghost\_cell}};}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keywordtype}{double}\ uS\ =\ 0.0,\ vS\ =\ 0.0,\ wS\ =\ 0.0;}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{keywordtype}{int}\ one\ =\ 1;}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordtype}{int}\ d\ =\ 0;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{comment}{//\ *\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ In\ x\ direction\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keywordflow}{if}\ (location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}}\ ==\ nx\ -\/\ gc)\ \{}
\DoxyCodeLine{00023\ \ \ \ \ \ \ d\ =\ one;}
\DoxyCodeLine{00024\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ d\ =\ 0;}
\DoxyCodeLine{00026\ \ \ \ \ \}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ firstprivate(dt,\ location)}}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ location.\mbox{\hyperlink{class_local_domain_a47ac8bc4ed8a90613309ddced1869785}{x\_start}};\ i\ <\ location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}}\ -\/\ d;\ ++i)}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ j\ =\ location.\mbox{\hyperlink{class_local_domain_af8a435144ad06a2bb6a290a341dab55e}{y\_start}};\ j\ <\ location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}};\ ++j)}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ k\ =\ location.\mbox{\hyperlink{class_local_domain_a7a4df338f67d20b9780e909913e93d10}{z\_start}};\ k\ <\ location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}};\ ++k)\ \{}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ temp\_u\ =\ old\_vel.\mbox{\hyperlink{class_staggered_velocity_aa6247ed37fbf51bbfe8bd31c567d7336}{U}}(i,\ j,\ k)-\/\ dt\ *\ (pressure(i+1,\ j,\ k)\ -\/\ pressure(i,\ j,\ k))\ /\ grid.\mbox{\hyperlink{class_structured_grid_a5bd12a20ac073c97474ce70974b4462a}{staggered\_dx}}[i];}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ eta\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +\ (\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i+1,\ j,\ k)\ -\/\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k))\ *}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grid.\mbox{\hyperlink{class_structured_grid_ac6bab642319bfac3b895a25577a2341d}{GetInterpolationX}}(i);}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ curr\_vel.\mbox{\hyperlink{class_staggered_velocity_aa6247ed37fbf51bbfe8bd31c567d7336}{U}}(i,\ j,\ k)\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ *\ uS\ +\ (1.0\ -\/\ eta)\ *\ temp\_u;}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ dfib.\mbox{\hyperlink{class_immersed_boundary_a568875b9c29c693ec5fc4c49393dff44}{Fx}}(i,\ j,\ k)\ =\ (curr\_vel.\mbox{\hyperlink{class_staggered_velocity_aa6247ed37fbf51bbfe8bd31c567d7336}{U}}(i,\ j,\ k)\ -\/\ temp\_u)\ /\ dt;}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordflow}{if}\ (location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}}\ ==\ ny\ -\/\ gc)\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ d\ =\ one;}
\DoxyCodeLine{00041\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ d\ =\ 0;}
\DoxyCodeLine{00043\ \ \ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ firstprivate(dt,\ location)}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ location.\mbox{\hyperlink{class_local_domain_a47ac8bc4ed8a90613309ddced1869785}{x\_start}};\ i\ <\ location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}};\ ++i)}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ j\ =\ location.\mbox{\hyperlink{class_local_domain_af8a435144ad06a2bb6a290a341dab55e}{y\_start}};\ j\ <\ location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}}\ -\/\ d;\ ++j)}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ k\ =\ location.\mbox{\hyperlink{class_local_domain_a7a4df338f67d20b9780e909913e93d10}{z\_start}};\ k\ <\ location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}};\ ++k)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ temp\_v\ =\ old\_vel.\mbox{\hyperlink{class_staggered_velocity_a84a6565ddac26a98251453d89767426e}{V}}(i,\ j,\ k)\ -\/\ dt\ *\ (pressure(i,\ j+1,\ k)\ -\/\ pressure(i,\ j,\ k))\ /\ grid.\mbox{\hyperlink{class_structured_grid_af7c6335a3ff2f6b7b7906bab19ad4e9c}{staggered\_dy}}[j];}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ eta\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j+1,\ k)\ -\/\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k))\ *\ grid.\mbox{\hyperlink{class_structured_grid_a14be4781183267a67bf0d8bd582b7c3f}{GetInterpolationY}}(j);}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ curr\_vel.\mbox{\hyperlink{class_staggered_velocity_a84a6565ddac26a98251453d89767426e}{V}}(i,\ j,\ k)\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ *\ vS\ +\ (1.0\ -\/\ eta)\ *\ temp\_v;}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ dfib.\mbox{\hyperlink{class_immersed_boundary_a54124ae85a875883cc3db0dcd8f6a825}{Fy}}(i,\ j,\ k)=\ (curr\_vel.\mbox{\hyperlink{class_staggered_velocity_a84a6565ddac26a98251453d89767426e}{V}}(i,\ j,\ k)\ -\/\ temp\_v)\ /\ dt;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ *\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ In\ z\ direction\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordflow}{if}\ (location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}}\ ==\ nz\ -\/\ gc)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ d\ =\ one;}
\DoxyCodeLine{00059\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ d\ =\ 0;}
\DoxyCodeLine{00061\ \ \ \ \ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ firstprivate(dt,\ location)}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ location.\mbox{\hyperlink{class_local_domain_a47ac8bc4ed8a90613309ddced1869785}{x\_start}};\ i\ <\ location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}};\ ++i)}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ j\ =\ location.\mbox{\hyperlink{class_local_domain_af8a435144ad06a2bb6a290a341dab55e}{y\_start}};\ j\ <\ location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}};\ ++j)}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ k\ =\ location.\mbox{\hyperlink{class_local_domain_a7a4df338f67d20b9780e909913e93d10}{z\_start}};\ k\ <\ location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}}\ -\/\ d;\ ++k)\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ temp\_w\ =\ old\_vel.\mbox{\hyperlink{class_staggered_velocity_adb2f88931c3cca29866c5334bec50ee1}{W}}(i,\ j,\ k)-\/\ dt\ *\ (pressure(i,\ j,\ k+1)\ -\/\ pressure(i,\ j,\ k))\ /\ grid.\mbox{\hyperlink{class_structured_grid_aac82704de7801674619cdfd14c51200d}{staggered\_dz}}[k];}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ eta\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k+1)-\/\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k))\ *\ grid.\mbox{\hyperlink{class_structured_grid_a5344bf6bc8fe189fe3c8d3f4b1f6d891}{GetInterpolationZ}}(k);}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ curr\_vel.\mbox{\hyperlink{class_staggered_velocity_adb2f88931c3cca29866c5334bec50ee1}{W}}(i,\ j,\ k)\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ *\ wS\ +\ (1.0\ -\/\ eta)\ *\ temp\_w;}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ dfib.\mbox{\hyperlink{class_immersed_boundary_a52d07f96ae0fc1778f2c9f67a65d68be}{Fz}}(i,\ j,\ k)\ =\ (curr\_vel.\mbox{\hyperlink{class_staggered_velocity_adb2f88931c3cca29866c5334bec50ee1}{W}}(i,\ j,\ k)\ -\/\ temp\_w)\ /\ dt;}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00073\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{physical__variables_8hpp_source_l00156}{Immersed\+Boundary\+::\+Eta()}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00141}{Immersed\+Boundary\+::\+Fx()}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00146}{Immersed\+Boundary\+::\+Fy()}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00151}{Immersed\+Boundary\+::\+Fz()}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00169}{Structured\+Grid\+::\+Get\+Interpolation\+X()}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00170}{Structured\+Grid\+::\+Get\+Interpolation\+Y()}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00171}{Structured\+Grid\+::\+Get\+Interpolation\+Z()}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00061}{Structured\+Grid\+::no\+\_\+ghost\+\_\+cell}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00064}{Structured\+Grid\+::nx}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00065}{Structured\+Grid\+::ny}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00066}{Structured\+Grid\+::nz}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00072}{Structured\+Grid\+::staggered\+\_\+dx}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00072}{Structured\+Grid\+::staggered\+\_\+dy}}, \mbox{\hyperlink{structured__grid_8hpp_source_l00072}{Structured\+Grid\+::staggered\+\_\+dz}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00057}{Staggered\+Velocity\+::\+U()}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00062}{Staggered\+Velocity\+::\+V()}}, \mbox{\hyperlink{physical__variables_8hpp_source_l00067}{Staggered\+Velocity\+::\+W()}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::x\+\_\+end}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::x\+\_\+start}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::y\+\_\+end}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::y\+\_\+start}}, \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::z\+\_\+end}}, and \mbox{\hyperlink{domain_8hpp_source_l00042}{Local\+Domain\+::z\+\_\+start}}.

