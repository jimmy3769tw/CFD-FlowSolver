\doxysection{update\+\_\+u\+\_\+and\+\_\+force.\+hpp}
\hypertarget{update__u__and__force_8hpp_source}{}\label{update__u__and__force_8hpp_source}\index{cfd\_mx/inc/dfib/update\_u\_and\_force.hpp@{cfd\_mx/inc/dfib/update\_u\_and\_force.hpp}}
\mbox{\hyperlink{update__u__and__force_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00001}00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{physical__variables_8hpp}{backend/physical\_variables.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ "{}../backend/domain.hpp"{}}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ "{}../grid/structured\_grid.hpp"{}}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00007}\mbox{\hyperlink{update__u__and__force_8hpp_a9de53d7f5d4d7ae0ead7f7c31a2a27da}{00007}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{update__u__and__force_8hpp_a9de53d7f5d4d7ae0ead7f7c31a2a27da}{UpdateForceAndVelocity}}(\mbox{\hyperlink{class_immersed_boundary}{ImmersedBoundary}}\&\ dfib,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ dt,}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00008}00008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_pressure}{Pressure}}\&\ pressure,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_staggered_velocity}{StaggeredVelocity}}\&\ old\_vel,}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00009}00009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_staggered_velocity}{StaggeredVelocity}}\&\ curr\_vel,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_local_domain}{LocalDomain}}\&\ location,\ \mbox{\hyperlink{class_structured_grid}{StructuredGrid}}\&\ grid)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00011}00011\ \ \ \ \ \textcolor{keyword}{auto}\ nx\ =\ grid.\mbox{\hyperlink{class_structured_grid_a729ba22ec783944242e7279c7edbd9d3}{nx}};}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00012}00012\ \ \ \ \ \textcolor{keyword}{auto}\ ny\ =\ grid.\mbox{\hyperlink{class_structured_grid_acd2c4a5c87de501e98173c83838978b6}{ny}};}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00013}00013\ \ \ \ \ \textcolor{keyword}{auto}\ nz\ =\ grid.\mbox{\hyperlink{class_structured_grid_a6d376bf512f0064c82b1af557dd59dd3}{nz}};}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00014}00014\ \ \ \ \ \textcolor{keyword}{auto}\ gc\ =\ grid.\mbox{\hyperlink{class_structured_grid_a588ce27c2f4a42580d8c7ea85524a427}{no\_ghost\_cell}};}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00016}00016\ \ \ \ \ \textcolor{keywordtype}{double}\ uS\ =\ 0.0,\ vS\ =\ 0.0,\ wS\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00018}00018\ \ \ \ \ \textcolor{keywordtype}{int}\ one\ =\ 1;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00019}00019\ \ \ \ \ \textcolor{keywordtype}{int}\ d\ =\ 0;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00021}00021\ \ \ \ \ \textcolor{comment}{//\ *\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ In\ x\ direction\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00022}00022\ \ \ \ \ \textcolor{keywordflow}{if}\ (location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}}\ ==\ nx\ -\/\ gc)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00023}00023\ \ \ \ \ \ \ d\ =\ one;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00024}00024\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00025}00025\ \ \ \ \ \ \ d\ =\ 0;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00026}00026\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00028}00028\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ firstprivate(dt,\ location)}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00029}00029\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ location.\mbox{\hyperlink{class_local_domain_a47ac8bc4ed8a90613309ddced1869785}{x\_start}};\ i\ <\ location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}}\ -\/\ d;\ ++i)}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00030}00030\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ j\ =\ location.\mbox{\hyperlink{class_local_domain_af8a435144ad06a2bb6a290a341dab55e}{y\_start}};\ j\ <\ location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}};\ ++j)}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00031}00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ k\ =\ location.\mbox{\hyperlink{class_local_domain_a7a4df338f67d20b9780e909913e93d10}{z\_start}};\ k\ <\ location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}};\ ++k)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ temp\_u\ =\ old\_vel.\mbox{\hyperlink{class_staggered_velocity_aa6247ed37fbf51bbfe8bd31c567d7336}{U}}(i,\ j,\ k)-\/\ dt\ *\ (pressure(i+1,\ j,\ k)\ -\/\ pressure(i,\ j,\ k))\ /\ grid.\mbox{\hyperlink{class_structured_grid_a5bd12a20ac073c97474ce70974b4462a}{staggered\_dx}}[i];}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ eta\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +\ (\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i+1,\ j,\ k)\ -\/\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k))\ *}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grid.\mbox{\hyperlink{class_structured_grid_ac6bab642319bfac3b895a25577a2341d}{GetInterpolationX}}(i);}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ curr\_vel.\mbox{\hyperlink{class_staggered_velocity_aa6247ed37fbf51bbfe8bd31c567d7336}{U}}(i,\ j,\ k)\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ *\ uS\ +\ (1.0\ -\/\ eta)\ *\ temp\_u;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ dfib.\mbox{\hyperlink{class_immersed_boundary_a568875b9c29c693ec5fc4c49393dff44}{Fx}}(i,\ j,\ k)\ =\ (curr\_vel.\mbox{\hyperlink{class_staggered_velocity_aa6247ed37fbf51bbfe8bd31c567d7336}{U}}(i,\ j,\ k)\ -\/\ temp\_u)\ /\ dt;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00037}00037\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00039}00039\ \ \ \ \ \textcolor{keywordflow}{if}\ (location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}}\ ==\ ny\ -\/\ gc)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00040}00040\ \ \ \ \ \ \ d\ =\ one;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00041}00041\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00042}00042\ \ \ \ \ \ \ d\ =\ 0;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00043}00043\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00045}00045\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ firstprivate(dt,\ location)}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00046}00046\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ location.\mbox{\hyperlink{class_local_domain_a47ac8bc4ed8a90613309ddced1869785}{x\_start}};\ i\ <\ location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}};\ ++i)}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00047}00047\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ j\ =\ location.\mbox{\hyperlink{class_local_domain_af8a435144ad06a2bb6a290a341dab55e}{y\_start}};\ j\ <\ location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}}\ -\/\ d;\ ++j)}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ k\ =\ location.\mbox{\hyperlink{class_local_domain_a7a4df338f67d20b9780e909913e93d10}{z\_start}};\ k\ <\ location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}};\ ++k)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ temp\_v\ =\ old\_vel.\mbox{\hyperlink{class_staggered_velocity_a84a6565ddac26a98251453d89767426e}{V}}(i,\ j,\ k)\ -\/\ dt\ *\ (pressure(i,\ j+1,\ k)\ -\/\ pressure(i,\ j,\ k))\ /\ grid.\mbox{\hyperlink{class_structured_grid_af7c6335a3ff2f6b7b7906bab19ad4e9c}{staggered\_dy}}[j];}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ eta\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j+1,\ k)\ -\/\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k))\ *\ grid.\mbox{\hyperlink{class_structured_grid_a14be4781183267a67bf0d8bd582b7c3f}{GetInterpolationY}}(j);}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ curr\_vel.\mbox{\hyperlink{class_staggered_velocity_a84a6565ddac26a98251453d89767426e}{V}}(i,\ j,\ k)\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ *\ vS\ +\ (1.0\ -\/\ eta)\ *\ temp\_v;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ dfib.\mbox{\hyperlink{class_immersed_boundary_a54124ae85a875883cc3db0dcd8f6a825}{Fy}}(i,\ j,\ k)=\ (curr\_vel.\mbox{\hyperlink{class_staggered_velocity_a84a6565ddac26a98251453d89767426e}{V}}(i,\ j,\ k)\ -\/\ temp\_v)\ /\ dt;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00056}00056\ \ \ \ \ \textcolor{comment}{//\ *\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ In\ z\ direction\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00057}00057\ \ \ \ \ \textcolor{keywordflow}{if}\ (location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}}\ ==\ nz\ -\/\ gc)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00058}00058\ \ \ \ \ \ \ d\ =\ one;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00059}00059\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00060}00060\ \ \ \ \ \ \ d\ =\ 0;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00061}00061\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00063}00063\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ firstprivate(dt,\ location)}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00064}00064\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ location.\mbox{\hyperlink{class_local_domain_a47ac8bc4ed8a90613309ddced1869785}{x\_start}};\ i\ <\ location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}};\ ++i)}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00065}00065\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ j\ =\ location.\mbox{\hyperlink{class_local_domain_af8a435144ad06a2bb6a290a341dab55e}{y\_start}};\ j\ <\ location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}};\ ++j)}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00066}00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ k\ =\ location.\mbox{\hyperlink{class_local_domain_a7a4df338f67d20b9780e909913e93d10}{z\_start}};\ k\ <\ location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}}\ -\/\ d;\ ++k)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ temp\_w\ =\ old\_vel.\mbox{\hyperlink{class_staggered_velocity_adb2f88931c3cca29866c5334bec50ee1}{W}}(i,\ j,\ k)-\/\ dt\ *\ (pressure(i,\ j,\ k+1)\ -\/\ pressure(i,\ j,\ k))\ /\ grid.\mbox{\hyperlink{class_structured_grid_aac82704de7801674619cdfd14c51200d}{staggered\_dz}}[k];}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ eta\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k+1)-\/\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k))\ *\ grid.\mbox{\hyperlink{class_structured_grid_a5344bf6bc8fe189fe3c8d3f4b1f6d891}{GetInterpolationZ}}(k);}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ curr\_vel.\mbox{\hyperlink{class_staggered_velocity_adb2f88931c3cca29866c5334bec50ee1}{W}}(i,\ j,\ k)\ =\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ *\ wS\ +\ (1.0\ -\/\ eta)\ *\ temp\_w;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ dfib.\mbox{\hyperlink{class_immersed_boundary_a52d07f96ae0fc1778f2c9f67a65d68be}{Fz}}(i,\ j,\ k)\ =\ (curr\_vel.\mbox{\hyperlink{class_staggered_velocity_adb2f88931c3cca29866c5334bec50ee1}{W}}(i,\ j,\ k)\ -\/\ temp\_w)\ /\ dt;}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00072}00072\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00073}00073\ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00075}\mbox{\hyperlink{update__u__and__force_8hpp_a7750d4010a2aefa928f308348ca499af}{00075}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{update__u__and__force_8hpp_a7750d4010a2aefa928f308348ca499af}{RemoveVelocity}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_immersed_boundary}{ImmersedBoundary}}\&\ dfib,\ \mbox{\hyperlink{class_staggered_velocity}{StaggeredVelocity}}\&\ vel,}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_local_domain}{LocalDomain}}\&\ location)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00077}00077\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ firstprivate(location)}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00078}00078\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00079}00079\ \textcolor{preprocessor}{\#pragma\ omp\ for\ simd\ nowait}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00080}00080\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ location.\mbox{\hyperlink{class_local_domain_a47ac8bc4ed8a90613309ddced1869785}{x\_start}};\ i\ <\ location.\mbox{\hyperlink{class_local_domain_a85bd90711f78af744bae30e52241d018}{x\_end}};\ ++i)}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ j\ =\ location.\mbox{\hyperlink{class_local_domain_af8a435144ad06a2bb6a290a341dab55e}{y\_start}};\ j\ <\ location.\mbox{\hyperlink{class_local_domain_ab829648563fa006676434a7e9ca478d0}{y\_end}};\ ++j)}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ k\ =\ location.\mbox{\hyperlink{class_local_domain_a7a4df338f67d20b9780e909913e93d10}{z\_start}};\ k\ <\ location.\mbox{\hyperlink{class_local_domain_a18b65e119ec8720a8c297706db7e8a8c}{z\_end}};\ ++k)\ \{}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ vel.\mbox{\hyperlink{class_staggered_velocity_aa6247ed37fbf51bbfe8bd31c567d7336}{U}}(i,\ j,\ k)\ *=\ 0.5\ *\ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i\ +\ 1,\ j,\ k));}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ vel.\mbox{\hyperlink{class_staggered_velocity_a84a6565ddac26a98251453d89767426e}{V}}(i,\ j,\ k)\ *=\ 0.5\ *\ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j\ +\ 1,\ k));}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ vel.\mbox{\hyperlink{class_staggered_velocity_adb2f88931c3cca29866c5334bec50ee1}{W}}(i,\ j,\ k)\ *=\ 0.5\ *\ (dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k)\ +\ dfib.\mbox{\hyperlink{class_immersed_boundary_aeebacdcadece1a8a11d9fcdf61971671}{Eta}}(i,\ j,\ k\ +\ 1));}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00087}00087\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{update__u__and__force_8hpp_source_l00088}00088\ \}}

\end{DoxyCode}
