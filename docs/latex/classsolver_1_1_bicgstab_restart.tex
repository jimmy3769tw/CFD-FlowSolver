\doxysection{solver\+::Bicgstab\+Restart\texorpdfstring{$<$}{<} matrixT \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{classsolver_1_1_bicgstab_restart}{}\label{classsolver_1_1_bicgstab_restart}\index{solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}}


{\ttfamily \#include $<$bicgstab\+\_\+restart.\+hpp$>$}

Inheritance diagram for solver\+::Bicgstab\+Restart\texorpdfstring{$<$}{<} matrixT \texorpdfstring{$>$}{>}\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classsolver_1_1_bicgstab_restart}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsolver_1_1_bicgstab_restart_afc6a10a4987cd701fc906c27aa10987b}{Bicgstab\+Restart}} ()
\item 
\mbox{\hyperlink{classsolver_1_1_bicgstab_restart_a6e80d12458e48136869131272cc8e63c}{Bicgstab\+Restart}} (matrixT \&lhs\+\_\+mat)
\item 
virtual \mbox{\hyperlink{classsolver_1_1_bicgstab_restart_aab1ffcd0769a212aa130ff22fc63c5cf}{\texorpdfstring{$\sim$}{\string~}\+Bicgstab\+Restart}} ()
\item 
void \mbox{\hyperlink{classsolver_1_1_bicgstab_restart_a7035a262800921538bb1890c5269bb89}{init}} (matrixT \&lhs\+\_\+mat)
\item 
void \mbox{\hyperlink{classsolver_1_1_bicgstab_restart_aaf7d57ea70b27435f8b62d7e0103d5dc}{Set\+Tolerance}} (double tolerance) override
\item 
std\+::tuple$<$ int, double $>$ \mbox{\hyperlink{classsolver_1_1_bicgstab_restart_aa8ee9841c6e639303e9576cffef1d92e}{solve}} (const std\+::vector$<$ double $>$ \&rhs, std\+::vector$<$ double $>$ \&x) override
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classsolver_1_1_linear_solver}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsolver_1_1_linear_solver_aaf7a0ba705302fc8dc9c2795024fe008}{Linear\+Solver}} ()
\item 
\mbox{\hyperlink{classsolver_1_1_linear_solver_ae6b162c2e6a567fc0b72cfef9230c4b5}{Linear\+Solver}} (matrixT \&lhs\+\_\+mat)
\item 
virtual \mbox{\hyperlink{classsolver_1_1_linear_solver_a93d4eafccfb65d56255e7c000b9aaa81}{\texorpdfstring{$\sim$}{\string~}\+Linear\+Solver}} ()
\item 
void \mbox{\hyperlink{classsolver_1_1_linear_solver_a06cad797874373694b16809a61887b26}{construct}} (const matrixT \&lhs\+\_\+mat)
\item 
void \mbox{\hyperlink{classsolver_1_1_linear_solver_af8b281cce1dc38306916519629b12c97}{Set\+Max\+Iters}} (int niters)
\item 
std\+::tuple$<$ int, double $>$ \mbox{\hyperlink{classsolver_1_1_linear_solver_a801c5d38d430bb268385b0f8032adf18}{operator()}} (const std\+::vector$<$ double $>$ \&rhs, std\+::vector$<$ double $>$ \&x)
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classsolver_1_1_linear_solver}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$}}}
\begin{DoxyCompactItemize}
\item 
double \mbox{\hyperlink{classsolver_1_1_linear_solver_a551bf5c4443b636637c342a693937263}{Inner\+Product}} (const std\+::vector$<$ double $>$ \&rhs, const std\+::vector$<$ double $>$ \&x)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{classsolver_1_1_linear_solver}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$}}}
\begin{DoxyCompactItemize}
\item 
matrixT \mbox{\hyperlink{classsolver_1_1_linear_solver_abd9f2b7267dd4150a8877555911b4cce}{lhs\+\_\+mat\+\_\+}}
\item 
double \mbox{\hyperlink{classsolver_1_1_linear_solver_a42c60219796ef9676d5c71f11f39fcc5}{tolerance\+\_\+}} \{1e-\/5\}
\item 
int \mbox{\hyperlink{classsolver_1_1_linear_solver_a653bc47bc35768ba93e2840762913f98}{iters\+\_\+max\+\_\+}} \{3000\}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename matrixT$>$\newline
class solver\+::\+Bicgstab\+Restart$<$ matrix\+T $>$}


Definition at line \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00009}{9}} of file \mbox{\hyperlink{bicgstab__restart_8hpp_source}{bicgstab\+\_\+restart.\+hpp}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsolver_1_1_bicgstab_restart_afc6a10a4987cd701fc906c27aa10987b}\label{classsolver_1_1_bicgstab_restart_afc6a10a4987cd701fc906c27aa10987b} 
\index{solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}!BicgstabRestart@{BicgstabRestart}}
\index{BicgstabRestart@{BicgstabRestart}!solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{BicgstabRestart()}{BicgstabRestart()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
\mbox{\hyperlink{classsolver_1_1_bicgstab_restart}{solver\+::\+Bicgstab\+Restart}}$<$ matrixT $>$\+::\+Bicgstab\+Restart (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00011}{11}} of file \mbox{\hyperlink{bicgstab__restart_8hpp_source}{bicgstab\+\_\+restart.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00011\ \{\}}

\end{DoxyCode}
\Hypertarget{classsolver_1_1_bicgstab_restart_a6e80d12458e48136869131272cc8e63c}\label{classsolver_1_1_bicgstab_restart_a6e80d12458e48136869131272cc8e63c} 
\index{solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}!BicgstabRestart@{BicgstabRestart}}
\index{BicgstabRestart@{BicgstabRestart}!solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{BicgstabRestart()}{BicgstabRestart()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
\mbox{\hyperlink{classsolver_1_1_bicgstab_restart}{solver\+::\+Bicgstab\+Restart}}$<$ matrixT $>$\+::\+Bicgstab\+Restart (\begin{DoxyParamCaption}\item[{matrixT \&}]{lhs\+\_\+mat }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00013}{13}} of file \mbox{\hyperlink{bicgstab__restart_8hpp_source}{bicgstab\+\_\+restart.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ LinearSolver<matrixT>(lhs\_mat)\ \{}
\DoxyCodeLine{00014\ \ \ \ \ \mbox{\hyperlink{classsolver_1_1_bicgstab_restart_a7035a262800921538bb1890c5269bb89}{init}}(lhs\_mat);}
\DoxyCodeLine{00015\ \ \ \}}

\end{DoxyCode}


References \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00019}{solver\+::\+Bicgstab\+Restart$<$ matrix\+T $>$\+::init()}}.

\Hypertarget{classsolver_1_1_bicgstab_restart_aab1ffcd0769a212aa130ff22fc63c5cf}\label{classsolver_1_1_bicgstab_restart_aab1ffcd0769a212aa130ff22fc63c5cf} 
\index{solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}!````~BicgstabRestart@{\texorpdfstring{$\sim$}{\string~}BicgstabRestart}}
\index{````~BicgstabRestart@{\texorpdfstring{$\sim$}{\string~}BicgstabRestart}!solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}BicgstabRestart()}{\string~BicgstabRestart()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
virtual \mbox{\hyperlink{classsolver_1_1_bicgstab_restart}{solver\+::\+Bicgstab\+Restart}}$<$ matrixT $>$\+::\texorpdfstring{$\sim$}{\string~}\mbox{\hyperlink{classsolver_1_1_bicgstab_restart}{Bicgstab\+Restart}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Definition at line \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00017}{17}} of file \mbox{\hyperlink{bicgstab__restart_8hpp_source}{bicgstab\+\_\+restart.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00017\ \{\}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsolver_1_1_bicgstab_restart_a7035a262800921538bb1890c5269bb89}\label{classsolver_1_1_bicgstab_restart_a7035a262800921538bb1890c5269bb89} 
\index{solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}!init@{init}}
\index{init@{init}!solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
void \mbox{\hyperlink{classsolver_1_1_bicgstab_restart}{solver\+::\+Bicgstab\+Restart}}$<$ matrixT $>$\+::init (\begin{DoxyParamCaption}\item[{matrixT \&}]{lhs\+\_\+mat }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00019}{19}} of file \mbox{\hyperlink{bicgstab__restart_8hpp_source}{bicgstab\+\_\+restart.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00020\ \ \ \ \ length\_\ =\ this-\/>\mbox{\hyperlink{classsolver_1_1_linear_solver_abd9f2b7267dd4150a8877555911b4cce}{lhs\_mat\_}}.row();}
\DoxyCodeLine{00021\ \ \ \ \ r0\_.resize(length\_,\ 0.0);}
\DoxyCodeLine{00022\ \ \ \ \ r1\_.resize(length\_,\ 0.0);}
\DoxyCodeLine{00023\ \ \ \ \ p1\_.resize(length\_,\ 0.0);}
\DoxyCodeLine{00024\ \ \ \ \ s1\_.resize(length\_,\ 0.0);}
\DoxyCodeLine{00025\ \ \ \ \ ap\_.resize(length\_,\ 0.0);}
\DoxyCodeLine{00026\ \ \ \ \ as\_.resize(length\_,\ 0.0);}
\DoxyCodeLine{00027\ \ \ \ \ px1\_.resize(length\_,\ 0.0);}
\DoxyCodeLine{00028\ \ \ \ \ px2\_.resize(length\_,\ 0.0);}
\DoxyCodeLine{00029\ \ \ \}}

\end{DoxyCode}


References \mbox{\hyperlink{linear__solver_8hpp_source_l00037}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$\+::lhs\+\_\+mat\+\_\+}}.



Referenced by \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00013}{solver\+::\+Bicgstab\+Restart$<$ matrix\+T $>$\+::\+Bicgstab\+Restart()}}.

\Hypertarget{classsolver_1_1_bicgstab_restart_aaf7d57ea70b27435f8b62d7e0103d5dc}\label{classsolver_1_1_bicgstab_restart_aaf7d57ea70b27435f8b62d7e0103d5dc} 
\index{solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}!SetTolerance@{SetTolerance}}
\index{SetTolerance@{SetTolerance}!solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{SetTolerance()}{SetTolerance()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
void \mbox{\hyperlink{classsolver_1_1_bicgstab_restart}{solver\+::\+Bicgstab\+Restart}}$<$ matrixT $>$\+::\+Set\+Tolerance (\begin{DoxyParamCaption}\item[{double}]{tolerance }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{classsolver_1_1_linear_solver_aa775a3b06c65eedc5618bf75be98c134}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$}}.



Definition at line \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00031}{31}} of file \mbox{\hyperlink{bicgstab__restart_8hpp_source}{bicgstab\+\_\+restart.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00032\ \ \ \ \ this-\/>\mbox{\hyperlink{classsolver_1_1_linear_solver_a42c60219796ef9676d5c71f11f39fcc5}{tolerance\_}}\ =\ tolerance;}
\DoxyCodeLine{00033\ \ \ \ \ restartTol\_\ =\ pRestartFactor\_\ *\ this-\/>\mbox{\hyperlink{classsolver_1_1_linear_solver_a42c60219796ef9676d5c71f11f39fcc5}{tolerance\_}};}
\DoxyCodeLine{00034\ \ \ \}}

\end{DoxyCode}


References \mbox{\hyperlink{linear__solver_8hpp_source_l00038}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$\+::tolerance\+\_\+}}.



Referenced by \mbox{\hyperlink{run__cpu_8hpp_source_l00052}{projection\+\_\+method\+::\+Cpu\+Open\+Mp\+::solve()}}, \mbox{\hyperlink{matrix__test__amgcl_8cpp_source_l00039}{TEST()}}, \mbox{\hyperlink{mpi__openmp__matrix__test_8cpp_source_l00020}{TEST()}}, and \mbox{\hyperlink{mpi__openmp__matrix__test_8cpp_source_l00065}{TEST()}}.

\Hypertarget{classsolver_1_1_bicgstab_restart_aa8ee9841c6e639303e9576cffef1d92e}\label{classsolver_1_1_bicgstab_restart_aa8ee9841c6e639303e9576cffef1d92e} 
\index{solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}!solve@{solve}}
\index{solve@{solve}!solver::BicgstabRestart$<$ matrixT $>$@{solver::BicgstabRestart$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{solve()}{solve()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
std\+::tuple$<$ int, double $>$ \mbox{\hyperlink{classsolver_1_1_bicgstab_restart}{solver\+::\+Bicgstab\+Restart}}$<$ matrixT $>$\+::solve (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{rhs,  }\item[{std\+::vector$<$ double $>$ \&}]{x }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \mbox{\hyperlink{classsolver_1_1_linear_solver_afe2952917021d439028b569f2ce5398e}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$}}.



Definition at line \mbox{\hyperlink{bicgstab__restart_8hpp_source_l00036}{36}} of file \mbox{\hyperlink{bicgstab__restart_8hpp_source}{bicgstab\+\_\+restart.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ timestep\_++;}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{double}\ r1r0\ =\ 0,\ pre\_r1r0\ =\ 0,\ a\ =\ 0,\ w\ =\ 0,\ b\ =\ 0,}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ norm0\ =\ \mbox{\hyperlink{namespacemath_ad06f5b10b7545f42cbc6340a8e841709}{math::L2Norm}}(rhs);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ this-\/>\mbox{\hyperlink{classsolver_1_1_linear_solver_abd9f2b7267dd4150a8877555911b4cce}{lhs\_mat\_}}.Multiply(x,\ r0\_);}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00044\ \ \ \ \ \mbox{\hyperlink{namespacemath_a333a4caf7df255df3d0fb5940444a916}{math::copy}}(px1\_,\ px2\_);}
\DoxyCodeLine{00045\ \ \ \ \ \mbox{\hyperlink{namespacemath_a333a4caf7df255df3d0fb5940444a916}{math::copy}}(x,\ px1\_);}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ schedule(static)\ default(none)\ shared(rhs,\ r0\_)}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ length\_;\ ++i)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ r0\_[i]\ =\ rhs[i]\ -\/\ r0\_[i];}
\DoxyCodeLine{00050\ \ \ \ \ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \mbox{\hyperlink{namespacemath_a333a4caf7df255df3d0fb5940444a916}{math::copy}}(r0\_,\ r1\_);}
\DoxyCodeLine{00053\ \ \ \ \ \mbox{\hyperlink{namespacemath_a333a4caf7df255df3d0fb5940444a916}{math::copy}}(r0\_,\ p1\_);}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ r1r0\ =\ \mbox{\hyperlink{namespacemath_a39e84d12b2999ed9620ae1f9c26aae4e}{math::InnerProduct}}(r1\_,\ r0\_);}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{int}\ no\_iters\_\ =\ 0;}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classsolver_1_1_linear_solver_abd9f2b7267dd4150a8877555911b4cce}{lhs\_mat\_}}.Multiply(p1\_,\ ap\_);}
\DoxyCodeLine{00062\ \ \ \ \ \ \ a\ =\ r1r0\ /\ \mbox{\hyperlink{namespacemath_a39e84d12b2999ed9620ae1f9c26aae4e}{math::InnerProduct}}(ap\_,\ r0\_);}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ schedule(static)}}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ length\_;\ ++i)\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ s1\_[i]\ =\ r1\_[i]\ -\/\ a\ *\ ap\_[i];}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classsolver_1_1_linear_solver_abd9f2b7267dd4150a8877555911b4cce}{lhs\_mat\_}}.Multiply(s1\_,\ as\_);}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ w\ =\ \mbox{\hyperlink{namespacemath_a39e84d12b2999ed9620ae1f9c26aae4e}{math::InnerProduct}}(as\_,\ s1\_)\ /\ \mbox{\hyperlink{namespacemath_a39e84d12b2999ed9620ae1f9c26aae4e}{math::InnerProduct}}(as\_,\ as\_);}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ schedule(static)}}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ length\_;\ ++i)\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ x[i]\ +=\ a\ *\ p1\_[i]\ +\ w\ *\ s1\_[i];}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ r1\_[i]\ =\ s1\_[i]\ -\/\ w\ *\ as\_[i];}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ for\ terminating\ conditions}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{namespacemath_ad06f5b10b7545f42cbc6340a8e841709}{math::L2Norm}}(r1\_)\ /\ norm0)\ <\ this-\/>\mbox{\hyperlink{classsolver_1_1_linear_solver_a42c60219796ef9676d5c71f11f39fcc5}{tolerance\_}})\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \textcolor{comment}{//\ !\ \#\#\ Check\ for\ reset\ of\ bCGSTAB}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (no\_iters\_\ >=\ this-\/>\mbox{\hyperlink{classsolver_1_1_linear_solver_a653bc47bc35768ba93e2840762913f98}{iters\_max\_}})\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ResetMembers\ =\ 0;}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ schedule(static)\ reduction(+\ :\ ResetMembers)}}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ length\_;\ ++i)\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::isnan(x[i])\ ||\ std::isinf(x[i]))\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ x[i]\ =\ px1\_[i],\ ++ResetMembers;}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ResetMembers\ >\ length\_\ *\ 0.1)\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacemath_a333a4caf7df255df3d0fb5940444a916}{math::copy}}(px2\_,\ x);}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ accumulativeResetMembers\_\ +=\ length\_,\ ++pResets\_;}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ResetMembers\ !=\ 0)\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ accumulativeResetMembers\_\ +=\ ResetMembers,\ ++pResets\_;}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \textcolor{comment}{//\ *-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \ \ pre\_r1r0\ =\ r1r0;}
\DoxyCodeLine{00108\ \ \ \ \ \ \ r1r0\ =\ \mbox{\hyperlink{namespacemath_a39e84d12b2999ed9620ae1f9c26aae4e}{math::InnerProduct}}(r1\_,\ r0\_);}
\DoxyCodeLine{00109\ \ \ \ \ \ \ b\ =\ (a\ /\ w)\ *\ (r1r0\ /\ pre\_r1r0);}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ rho\ for\ restart}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (timestep\_\ <\ 10\ ||\ std::abs(pre\_r1r0)\ >\ restartTol\_)\ \{}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#pragma\ omp\ parallel\ for\ schedule(static)}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ length\_;\ ++i)\ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ p1\_[i]\ =\ r1\_[i]\ +\ b\ *\ (p1\_[i]\ -\/\ w\ *\ ap\_[i]);}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacemath_a333a4caf7df255df3d0fb5940444a916}{math::copy}}(r1\_,\ r0\_);}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacemath_a333a4caf7df255df3d0fb5940444a916}{math::copy}}(r1\_,\ p1\_);}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ ++numRestarts\_;}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ ++no\_iters\_;}
\DoxyCodeLine{00123\ \ \ \ \ \ \ ++total\_no\_iters\_;}
\DoxyCodeLine{00124\ \ \ \ \ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(no\_iters\_,\ \mbox{\hyperlink{namespacemath_ad06f5b10b7545f42cbc6340a8e841709}{math::L2Norm}}(r1\_)\ /\ norm0);}
\DoxyCodeLine{00127\ \ \ \}}

\end{DoxyCode}


References \mbox{\hyperlink{math_8hpp_source_l00031}{math\+::copy()}}, \mbox{\hyperlink{math_8hpp_source_l00036}{math\+::\+Inner\+Product()}}, \mbox{\hyperlink{linear__solver_8hpp_source_l00039}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$\+::iters\+\_\+max\+\_\+}}, \mbox{\hyperlink{math_8hpp_source_l00053}{math\+::\+L2\+Norm()}}, \mbox{\hyperlink{linear__solver_8hpp_source_l00037}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$\+::lhs\+\_\+mat\+\_\+}}, and \mbox{\hyperlink{linear__solver_8hpp_source_l00038}{solver\+::\+Linear\+Solver$<$ matrix\+T $>$\+::tolerance\+\_\+}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
cfd\+\_\+mx/inc/matrix/solver/\mbox{\hyperlink{bicgstab__restart_8hpp}{bicgstab\+\_\+restart.\+hpp}}\end{DoxyCompactItemize}
