\doxysection{solver\+::cg\texorpdfstring{$<$}{<} matrixT \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{classsolver_1_1cg}{}\label{classsolver_1_1cg}\index{solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}}


{\ttfamily \#include $<$cg.\+hpp$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classsolver_1_1cg_acf6a91809bcd29ac24ac06f2dbc24865}{cg}} (matrixT \&lhs\+\_\+mat)
\item 
virtual \mbox{\hyperlink{classsolver_1_1cg_aa87d9ef5115f86ac8ec69dc1b1a06af5}{\texorpdfstring{$\sim$}{\string~}cg}} ()
\item 
bool \mbox{\hyperlink{classsolver_1_1cg_a4b48a80c207316113e0914eb65113501}{init}} (const matrixT \&lhs\+\_\+mat)
\item 
void \mbox{\hyperlink{classsolver_1_1cg_a5ce52e5e6621bfef4bda2a62812644d1}{Set\+Tolerance}} (double tolerance)
\item 
std\+::pair$<$ int, double $>$ \mbox{\hyperlink{classsolver_1_1cg_a438ecd26d974484d32d2f228d4912618}{solve}} (const vector$<$ double $>$ \&rhs, vector$<$ double $>$ \&x)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename matrixT$>$\newline
class solver\+::cg$<$ matrix\+T $>$}


Definition at line \mbox{\hyperlink{cg_8hpp_source_l00005}{5}} of file \mbox{\hyperlink{cg_8hpp_source}{cg.\+hpp}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classsolver_1_1cg_acf6a91809bcd29ac24ac06f2dbc24865}\label{classsolver_1_1cg_acf6a91809bcd29ac24ac06f2dbc24865} 
\index{solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}!cg@{cg}}
\index{cg@{cg}!solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{cg()}{cg()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
\mbox{\hyperlink{classsolver_1_1cg}{solver\+::cg}}$<$ matrixT $>$\+::cg (\begin{DoxyParamCaption}\item[{matrixT \&}]{lhs\+\_\+mat }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{cg_8hpp_source_l00009}{9}} of file \mbox{\hyperlink{cg_8hpp_source}{cg.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00009\ \{\ \mbox{\hyperlink{classsolver_1_1cg_a4b48a80c207316113e0914eb65113501}{init}}(lhs\_mat);\}}

\end{DoxyCode}


References \mbox{\hyperlink{cg_8hpp_source_l00014}{solver\+::cg$<$ matrix\+T $>$\+::init()}}.

\Hypertarget{classsolver_1_1cg_aa87d9ef5115f86ac8ec69dc1b1a06af5}\label{classsolver_1_1cg_aa87d9ef5115f86ac8ec69dc1b1a06af5} 
\index{solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}!````~cg@{\texorpdfstring{$\sim$}{\string~}cg}}
\index{````~cg@{\texorpdfstring{$\sim$}{\string~}cg}!solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}cg()}{\string~cg()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
virtual \mbox{\hyperlink{classsolver_1_1cg}{solver\+::cg}}$<$ matrixT $>$\+::\texorpdfstring{$\sim$}{\string~}\mbox{\hyperlink{classsolver_1_1cg}{cg}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Definition at line \mbox{\hyperlink{cg_8hpp_source_l00011}{11}} of file \mbox{\hyperlink{cg_8hpp_source}{cg.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00011\ \{\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classsolver_1_1cg_a4b48a80c207316113e0914eb65113501}\label{classsolver_1_1cg_a4b48a80c207316113e0914eb65113501} 
\index{solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}!init@{init}}
\index{init@{init}!solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{init()}{init()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
bool \mbox{\hyperlink{classsolver_1_1cg}{solver\+::cg}}$<$ matrixT $>$\+::init (\begin{DoxyParamCaption}\item[{const matrixT \&}]{lhs\+\_\+mat }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{cg_8hpp_source_l00014}{14}} of file \mbox{\hyperlink{cg_8hpp_source}{cg.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_mat\_\ =\ lhs\_mat;}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ \ \ \ \ length\_\ =\ lhs\_mat.row();}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \ \ \ \ p\_.resize(length\_);}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \ \ \ \ r\_.resize(length\_);}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \ \ \ \ r2\_.resize(length\_);}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ v\_.resize(length\_);}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \ \ \ \ ss\_.resize(length\_);}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ t\_.resize(length\_);}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{cg_8hpp_source_l00009}{solver\+::cg$<$ matrix\+T $>$\+::cg()}}.

\Hypertarget{classsolver_1_1cg_a5ce52e5e6621bfef4bda2a62812644d1}\label{classsolver_1_1cg_a5ce52e5e6621bfef4bda2a62812644d1} 
\index{solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}!SetTolerance@{SetTolerance}}
\index{SetTolerance@{SetTolerance}!solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{SetTolerance()}{SetTolerance()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
void \mbox{\hyperlink{classsolver_1_1cg}{solver\+::cg}}$<$ matrixT $>$\+::\+Set\+Tolerance (\begin{DoxyParamCaption}\item[{double}]{tolerance }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{cg_8hpp_source_l00028}{28}} of file \mbox{\hyperlink{cg_8hpp_source}{cg.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00028\ \{\ zeta\_\ =\ tolerance;\}}

\end{DoxyCode}
\Hypertarget{classsolver_1_1cg_a438ecd26d974484d32d2f228d4912618}\label{classsolver_1_1cg_a438ecd26d974484d32d2f228d4912618} 
\index{solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}!solve@{solve}}
\index{solve@{solve}!solver::cg$<$ matrixT $>$@{solver::cg$<$ matrixT $>$}}
\doxysubsubsection{\texorpdfstring{solve()}{solve()}}
{\footnotesize\ttfamily template$<$typename matrixT $>$ \\
std\+::pair$<$ int, double $>$ \mbox{\hyperlink{classsolver_1_1cg}{solver\+::cg}}$<$ matrixT $>$\+::solve (\begin{DoxyParamCaption}\item[{const vector$<$ double $>$ \&}]{rhs,  }\item[{vector$<$ double $>$ \&}]{x }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{cg_8hpp_source_l00081}{81}} of file \mbox{\hyperlink{cg_8hpp_source}{cg.\+hpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00083\ \ \ \ \ \{}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ lhs\_mat\_.multiply(x,\ p\_);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ std::vector<double>\ r\_(m);}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ minus(B,\ p\_,\ r\_)}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ copy(r\_,\ p\_);}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ nu\ =\ inner\_product(r\_,\ r\_);}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ norm0\ =\ inner\_product(B\ ,B);}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ tolerance\ =\ std::pow((zeta\_\ *\ norm0),\ 2);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ iter=\ 1;\ \textcolor{keywordtype}{double}\ error;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{double}\ beta\ =\ 0.0;\ iter\ <\ iters\_max\_\ ;++iter)\{}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ q\ =\ multiply(p\_);}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ alpha\ =\ \ nu\ /\ std::inner\_product(p\_.begin(),\ p\_.end(),q.begin()\ ,0.0);}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0\ ;\ i\ <\ m\ ;++i\ )}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x[i]\ +=\ alpha\ *\ p\_[i];}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0\ ;\ i\ <\ m\ ;++i\ )}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r\_[i]\ -\/=\ alpha\ *\ q[i];}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ error\ =\ std::inner\_product(r\_.begin(),\ r\_.end(),\ r\_.begin()\ ,0.0);}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (error\ <\ tolerance)\{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ mu\ =\ std::inner\_product(r\_.begin(),\ r\_.end(),\ r\_.begin()\ ,0.0);}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ beta\ =\ mu\ /\ nu;}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0\ ;\ i\ <\ m\ ;++i\ )\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p\_[i]\ =\ r\_[i]\ +\ beta\ *p\_[i];}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ nu\ =\ mu;}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_pair(\ iter,\ std::sqrt(iter)\ /\ norm0);}
\DoxyCodeLine{00131\ \ \ \ \ \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
cfd\+\_\+mx/inc/matrix/solver/\mbox{\hyperlink{cg_8hpp}{cg.\+hpp}}\end{DoxyCompactItemize}
